# <img src="https://twiki.cern.ch/twiki/pub/BEABP/Logos/OMC_logo.png" height="28"> 3

This is the python-tool package of the optics measurements and corrections group (OMC).

If you are not part of that group, you will most likely have no use for the codes provided here, unless you have a 9km wide accelerator at home.
Feel free to use them anyway, if you wish!

## Documentation

- Autogenerated docs via `Sphinx` can be found on <https://pylhc.github.io/omc3/>.
- General documentation of the OMC-Teams software on <https://twiki.cern.ch/twiki/bin/view/BEABP/OMC>

## Getting Started

### Prerequisites

The codes use a multitude of packages as can be found in the [`setup.py`](setup.py) file.

Important ones are: `numpy`, `pandas` and `scipy`.

### Installing

To use the codes, a local copy should be obtained via git clonewhich then has to be either installed using
`pip install -e /path/to/omc3` or can be used temporarily by appending the path to PYTHONPATH.
Alternatively, the previous two steps can be combined with `pip install git+https://github.com/pylhc/omc3.git`.
Codes can be run with `python -m omc3.SCRIPT --FLAG ARGUMENT`.

## Description

This is the new repository ([old one](https://github.com/pylhc/Beta-Beat.src)) of the codes, rewritten for python 3.6+.  


## Functionality

Scripts to be executed lie in `/omc3` directory. These include
- hole_in_one.py to perform frequency on turn by turn BPM data and infer optics and more for a given accelerator
- madx_wrapper.py to start a MADX with a file or string as input
- model_creator.py to provide optics models required for optics analysis
- plot_spectrum.py to generate plots from files generated by frequency analysis
- run_kmod.py to analyse data from K-modulation and return measured optics functions
- tbt_converter.py to convert different turn by turn datatypes to sdds and add noise 

Some examples can be found in the test files.

### Changelog

- Still building up to first release.

### Implemented

- Madx wrapper
- Frequency Analysis of turn by turn
- Optics measurement analysis scripts
- Accelerator class
- K-mod


### Development in progress

- Accuracy tests
- Regression tests
- Responsematrix calculation
- Global corrections
- Amplitude detuning

## Quality checks

Issues and introduction of new features should take place in branches. After completion, a pull request should be created and merging into the master branch 
is possible after positive review of a reviewer. More details can be found [here](https://twiki.cern.ch/twiki/bin/view/BEABP/Git). 
Coding style guide is found [here](https://twiki.cern.ch/twiki/bin/view/BEABP/PythonStyleGuide). 

### Tests

- Pytest unit tests are run automatically after each commit via [Travis-CI](https://travis-ci.com/pylhc/omc3). 

### Maintainability

- Additional checks for code-complexity, design-rules, test-coverage, duplication on [CodeClimate](https://codeclimate.com/github/pylhc/omc3).


## Authors

* **pyLHC/OMC-Team** - *Working Group* - [pyLHC](https://github.com/orgs/pylhc/teams/omc-team)

## License
This project is licensed under the GNU GPLv3 License - see the [LICENSE](LICENSE) file for details.