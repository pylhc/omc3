

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Main Entrypoints &mdash; omc3 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Definitions" href="../definitions/index.html" />
    <link rel="prev" title="Welcome to omc3’s documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> omc3
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Main Entrypoints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-omc3.hole_in_one">Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#entrypoint-hole-in-one">Entrypoint hole_in_one</a></li>
<li class="toctree-l3"><a class="reference internal" href="#entrypoint-amplitude-detuning-analysis">Entrypoint Amplitude Detuning Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-omc3.madx_wrapper">MAD-X</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#entrypoint-madx-wrapper">Entrypoint madx_wrapper</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-omc3.tbt_converter">Converter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#entrypoint-tbt-converter">Entrypoint tbt_converter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-omc3.plotting.plot_optics_measurements">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plot-optics-measurements">Plot Optics Measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-tfs">Plot TFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-spectrum">Plot Spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-amplitude-detuning-results">Plot Amplitude Detuning Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-bbq">Plot BBQ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-omc3.scripts.merge_kmod_results">Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#merge-kmod-results">Merge KMOD Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-natural-tune-in-lin-files">Update Natural Tune in Lin-Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#write-mad-x-macros">Write MAD-X Macros</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../definitions/index.html">Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../harpy/index.html">Harpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optics_measurements/index.html">Optics Measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting/index.html">Plot-Subfunctions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tbt/index.html">Turn-by-Turn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tune_analysis/index.html">Tune Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utils</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">omc3</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Main Entrypoints</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/entrypoints/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="main-entrypoints">
<h1>Main Entrypoints<a class="headerlink" href="#main-entrypoints" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-omc3.hole_in_one">
<span id="analysis"></span><h2>Analysis<a class="headerlink" href="#module-omc3.hole_in_one" title="Permalink to this headline">¶</a></h2>
<div class="section" id="entrypoint-hole-in-one">
<h3>Entrypoint hole_in_one<a class="headerlink" href="#entrypoint-hole-in-one" title="Permalink to this headline">¶</a></h3>
<p>Created on 27/01/19</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lukas Malina</p>
</dd>
</dl>
<dl>
<dt>Top-level script, which computes:</dt><dd><p>frequency spectra of Turn-by-Turn BPM data
various lattice optics parameters from frequency spectra
various lattice optics parameters from Turn-by-Turn BPM data</p>
</dd>
<dt>Generally, analysis flows as follows:</dt><dd><p>Turn-by-Turn BPM data   ---&gt;    frequency spectra   ---&gt;    various lattice optics parameters</p>
</dd>
<dt>Stages represented by different files:</dt><dd><p>Sdds file:  .sdds      ---&gt;   Tfs files: .lin[xy]  ---&gt;    Tfs files: .tfs</p>
</dd>
<dt>To run either of the two or both steps, use options:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">--harpy</span></kbd></dt>
<dd><p>--optics</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py function">
<dt id="omc3.hole_in_one.hole_in_one_entrypoint">
<code class="sig-prename descclassname">omc3.hole_in_one.</code><code class="sig-name descname">hole_in_one_entrypoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em>, <em class="sig-param"><span class="n">rest</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/hole_in_one.html#hole_in_one_entrypoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.hole_in_one.hole_in_one_entrypoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs frequency analysis and measures lattice optics.</p>
<dl>
<dt>Hole_in_one Kwargs:</dt><dd><ul>
<li><p><strong>harpy</strong>: Runs frequency analysis</p>
<p>Flags: <strong>--harpy</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>optics</strong>: Measures the lattice optics</p>
<p>Flags: <strong>--optics</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
</ul>
</dd>
<dt>Harpy Kwargs:</dt><dd><ul>
<li><p><strong>files</strong>: TbT files to analyse</p>
<p>Flags: <strong>--files</strong>
Required: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p><strong>outputdir</strong>: Output directory.</p>
<p>Flags: <strong>--outputdir</strong>
Required: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p><strong>to_write</strong>: Choose the type of output.</p>
<p>Flags: <strong>--to_write</strong>
Choices: <code class="docutils literal notranslate"><span class="pre">('lin',</span> <span class="pre">'spectra',</span> <span class="pre">'full_spectra',</span> <span class="pre">'bpm_summary')</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">['lin',</span> <span class="pre">'bpm_summary']</span></code></p>
</li>
<li><p><strong>turns</strong> <em>(int)</em>: Turn index to start and first turn index to be ignored.</p>
<p>Flags: <strong>--turns</strong>
Default: <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">50000]</span></code></p>
</li>
<li><p><strong>unit</strong> <em>(str)</em>: A unit of TbT BPM orbit data. All cuts and output are in ‘m’.</p>
<p>Flags: <strong>--unit</strong>
Choices: <code class="docutils literal notranslate"><span class="pre">('m',</span> <span class="pre">'cm',</span> <span class="pre">'mm',</span> <span class="pre">'um')</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">m</span></code></p>
</li>
<li><p><strong>tbt_datatype</strong> <em>(str)</em>: Choose datatype from which to import (e.g LHC binary SDDS, numpy npz).</p>
<p>Flags: <strong>--tbt_datatype</strong>
Default: <code class="docutils literal notranslate"><span class="pre">LHC</span></code></p>
</li>
</ul>
<p><em>--Cleaning--</em></p>
<ul>
<li><p><strong>clean</strong>: If present, the data are first cleaned.</p>
<p>Flags: <strong>--clean</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>bad_bpms</strong>: Bad BPMs to clean.</p>
<p>Flags: <strong>--bad_bpms</strong></p>
</li>
<li><p><strong>first_bpm</strong> <em>(str)</em>: First BPM in the measurement.
Used to resynchronise the TbT data with model.</p>
<p>Flags: <strong>--first_bpm</strong></p>
</li>
<li><p><strong>keep_exact_zeros</strong>: If present, will not remove BPMs with exact zeros in TbT data.</p>
<p>Flags: <strong>--keep_exact_zeros</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>max_peak</strong> <em>(float)</em>: Removes BPMs where the maximum orbit &gt; limit.</p>
<p>Flags: <strong>--max_peak</strong>
Default: <code class="docutils literal notranslate"><span class="pre">0.02</span></code></p>
</li>
<li><p><strong>model</strong>: Model for BPM locations</p>
<p>Flags: <strong>--model</strong></p>
</li>
<li><p><strong>num_svd_iterations</strong> <em>(int)</em>: Maximal number of iterations of U matrix elements removal
and renormalisation in iterative SVD cleaning of dominant BPMs.
This is also equal to maximal number of BPMs removed per SVD mode.</p>
<p>Flags: <strong>--num_svd_iterations</strong>
Default: <code class="docutils literal notranslate"><span class="pre">3</span></code></p>
</li>
<li><p><strong>opposite_direction</strong>: If present, beam in the opposite direction to model
is assumed for resynchronisation of BPMs.</p>
<p>Flags: <strong>--opposite_direction</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>peak_to_peak</strong> <em>(float)</em>: Peak to peak amplitude cut. This removes BPMs,
where abs(max(turn values) - min(turn values)) &lt;= threshold.</p>
<p>Flags: <strong>--peak_to_peak</strong>
Default: <code class="docutils literal notranslate"><span class="pre">1e-08</span></code></p>
</li>
<li><p><strong>sing_val</strong> <em>(int)</em>: Keep this amount of largest singular values.</p>
<p>Flags: <strong>--sing_val</strong>
Default: <code class="docutils literal notranslate"><span class="pre">12</span></code></p>
</li>
<li><p><strong>svd_dominance_limit</strong> <em>(float)</em>: Limit for single BPM dominating a mode.</p>
<p>Flags: <strong>--svd_dominance_limit</strong>
Default: <code class="docutils literal notranslate"><span class="pre">0.925</span></code></p>
</li>
<li><p><strong>wrong_polarity_bpms</strong>: BPMs with swapped polarity in both planes.</p>
<p>Flags: <strong>--wrong_polarity_bpms</strong></p>
</li>
</ul>
<p><em>--Frequency Analysis--</em></p>
<ul>
<li><p><strong>autotunes</strong> <em>(str)</em>: The main tunes are guessed as the strongest line in SV^T matrix
frequency spectrum: Synchrotron tune below ~0.03, betatron tunes above ~0.03.</p>
<p>Flags: <strong>--autotunes</strong>
Choices: <code class="docutils literal notranslate"><span class="pre">('all',</span> <span class="pre">'transverse')</span></code></p>
</li>
<li><p><strong>is_free_kick</strong>: If present, it will perform the free kick phase correction</p>
<p>Flags: <strong>--free_kick</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>natdeltas</strong> <em>(float)</em>: Guess for the offsets of natural tunes from
the driven tunes (x, y, z). Disabled when set to 0.</p>
<p>Flags: <strong>--natdeltas</strong></p>
</li>
<li><p><strong>nattunes</strong> <em>(float)</em>: Guess for the natural tunes (x, y, z).  Disabled when set to 0.</p>
<p>Flags: <strong>--nattunes</strong></p>
</li>
<li><p><strong>output_bits</strong> <em>(int)</em>: Number (frequency, complex coefficient) pairs in the output
is up to 2 ** output_bits (maximal in case full spectra is output).
There is one pair (with maximal amplitude of complex coefficient) per interval
of size 2 ** (- output_bits - 1).</p>
<p>Flags: <strong>--output_bits</strong>
Default: <code class="docutils literal notranslate"><span class="pre">12</span></code></p>
</li>
<li><p><strong>tolerance</strong> <em>(float)</em>: Tolerance specifying an interval in frequency domain,
where to look for the tunes.</p>
<p>Flags: <strong>--tolerance</strong>
Default: <code class="docutils literal notranslate"><span class="pre">0.01</span></code></p>
</li>
<li><p><strong>tune_clean_limit</strong> <em>(float)</em>: The tune cleaning wont remove BPMs because of measured
tune outliers closer to the average tune than this limit.</p>
<p>Flags: <strong>--tune_clean_limit</strong>
Default: <code class="docutils literal notranslate"><span class="pre">1e-05</span></code></p>
</li>
<li><p><strong>tunes</strong> <em>(float)</em>: Guess for the main tunes [x, y, z]. Tunez is disabled when set to 0</p>
<p>Flags: <strong>--tunes</strong></p>
</li>
<li><p><strong>turn_bits</strong> <em>(int)</em>: Number (frequency, complex coefficient) pairs in the calculation
is 2 ** turn_bits, i.e. the difference between two neighbouring frequencies
is 2 ** (- turn_bits - 1).</p>
<p>Flags: <strong>--turn_bits</strong>
Default: <code class="docutils literal notranslate"><span class="pre">20</span></code></p>
</li>
<li><p><strong>window</strong> <em>(str)</em>: Windowing function to be used for frequency analysis.</p>
<p>Flags: <strong>--window</strong>
Choices: <code class="docutils literal notranslate"><span class="pre">('rectangle',</span> <span class="pre">'welch',</span> <span class="pre">'triangle',</span> <span class="pre">'hann',</span> <span class="pre">'hamming',</span> <span class="pre">'nuttal3',</span> <span class="pre">'nuttal4')</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">hann</span></code></p>
</li>
</ul>
</dd>
<dt>Optics Kwargs:</dt><dd><ul>
<li><p><strong>files</strong>: Files for analysis</p>
<p>Flags: <strong>--files</strong>
Required: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p><strong>outputdir</strong>: Output directory</p>
<p>Flags: <strong>--outputdir</strong>
Required: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p><strong>calibrationdir</strong> <em>(str)</em>: Path to calibration files directory.</p>
<p>Flags: <strong>--calibrationdir</strong></p>
</li>
<li><p><strong>chromatic_beating</strong>: Calculate chromatic beatings: W, PHI and coupling</p>
<p>Flags: <strong>--chromatic_beating</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>coupling_method</strong> <em>(int)</em>: Coupling analysis option: disabled, 1 BPM or 2 BPMs method</p>
<p>Flags: <strong>--coupling_method</strong>
Choices: <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1,</span> <span class="pre">2)</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</li>
<li><p><strong>nonlinear</strong>: Calculate higher order RDTs</p>
<p>Flags: <strong>--nonlinear</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>only_coupling</strong>: Calculate only coupling.</p>
<p>Flags: <strong>--only_coupling</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>range_of_bpms</strong> <em>(int)</em>: Range of BPMs for beta from phase calculation</p>
<p>Flags: <strong>--range_of_bpms</strong>
Choices: <code class="docutils literal notranslate"><span class="pre">(5,</span> <span class="pre">7,</span> <span class="pre">9,</span> <span class="pre">11,</span> <span class="pre">13,</span> <span class="pre">15)</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">11</span></code></p>
</li>
<li><p><strong>three_bpm_method</strong>: Use 3 BPM method in beta from phase</p>
<p>Flags: <strong>--three_bpm_method</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>union</strong>: If present, the phase advances are calculate for union of BPMs
with at least 3 valid measurements, instead of intersection .</p>
<p>Flags: <strong>--union</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
</ul>
</dd>
<dt>Accelerator Kwargs:</dt><dd><ul>
<li><p><strong>accel</strong>: Choose the accelerator to use. More details can be found in omc3/model/manager.py</p>
<p>Flags: <strong>--accel</strong>
Required: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p><strong>model_dir</strong>: Model directory, specify if <code class="docutils literal notranslate"><span class="pre">--model</span></code> option is not used.</p>
<p>Flags: <strong>--model_dir</strong></p>
</li>
<li><p>For the rest, please see get_parameters() methods in child Accelerator classes,
which are declared in <code class="docutils literal notranslate"><span class="pre">omc3/model/accelerators/*.py</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-omc3.amplitude_detuning_analysis"></span><div class="section" id="entrypoint-amplitude-detuning-analysis">
<h3>Entrypoint Amplitude Detuning Analysis<a class="headerlink" href="#entrypoint-amplitude-detuning-analysis" title="Permalink to this headline">¶</a></h3>
<p>Entrypoint for amplitude detuning analysis.</p>
<p>This module provides functionality to run amplitude detuning analysis with
additionally getting BBQ data from timber, averaging and filtering this data and
subtracting it from the measurement data.</p>
<p>Furthermore, the orthogonal distance regression is utilized to get a
linear or quadratic fit from the measurements.</p>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul>
<li><p><strong>beam</strong> <em>(int)</em>: Which beam to use.</p></li>
<li><p><strong>kick</strong> <em>(str)</em>: Location of the kick files (parent folder).</p></li>
<li><p><strong>plane</strong> <em>(str)</em>: Plane of the kicks. ‘X’ or ‘Y’.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">('X',</span> <span class="pre">'Y')</span></code></p>
</li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>bbq_filtering_method</strong> <em>(str)</em>:Filtering method for the bbq to use. ‘cut’ cuts around a given tune,
‘minmax’ lets you specify the limits and ‘outliers’ uses the outlier filtering from utils.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['cut',</span> <span class="pre">'minmax',</span> <span class="pre">'outliers']</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">outliers</span></code></p>
</li>
<li><p><strong>bbq_in</strong>: Fill number of desired data to extract from timber
or path to presaved bbq-tfs-file. Use the string ‘kick’ to use the timestamps
in the kickfile for timber extraction. Not giving this parameter skips bbq compensation.</p></li>
<li><p><strong>debug</strong>: Activates Debug mode</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>detuning_order</strong> <em>(int)</em>: Order of the detuning as int. Basically just the order of the applied fit.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</li>
<li><p><strong>fine_cut</strong> <em>(float)</em>: Cut, i.e. tolerance, of the tune (fine cleaning for ‘minmax’ or ‘cut’).</p></li>
<li><p><strong>fine_window</strong> <em>(int)</em>: Length of the moving average window, i.e # data points (fine cleaning for ‘minmax’ or ‘cut’).</p></li>
<li><p><strong>label</strong> <em>(str)</em>: Label to identify this run.</p></li>
<li><p><strong>logfile</strong> <em>(str)</em>: Logfile if debug mode is active.</p></li>
<li><p><strong>outlier_limit</strong> <em>(float)</em>: Limit, i.e. cut, on outliers (Method ‘outliers’)</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">0.0002</span></code></p>
</li>
<li><p><strong>output</strong> <em>(str)</em>: Output directory for the modified kickfile and bbq data.</p></li>
<li><p><strong>tune_cut</strong> <em>(float)</em>: Cuts for the tune. For BBQ cleaning (Method ‘cut’).</p></li>
<li><p><strong>tunes</strong> <em>(float)</em>: Tunes for BBQ cleaning (Method ‘cut’).</p></li>
<li><p><strong>tunes_minmax</strong> <em>(float)</em>: Tunes minima and maxima in the order x_min, x_max, y_min, y_max. For BBQ cleaning (Method ‘minmax’).</p></li>
<li><p><strong>window_length</strong> <em>(int)</em>: Length of the moving average window. (# data points)</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">20</span></code></p>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Joschua Dilly</p>
</dd>
</dl>
<dl class="py function">
<dt id="omc3.amplitude_detuning_analysis.analyse_with_bbq_corrections">
<code class="sig-prename descclassname">omc3.amplitude_detuning_analysis.</code><code class="sig-name descname">analyse_with_bbq_corrections</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/amplitude_detuning_analysis.html#analyse_with_bbq_corrections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.amplitude_detuning_analysis.analyse_with_bbq_corrections" title="Permalink to this definition">¶</a></dt>
<dd><p>Create amplitude detuning analysis with BBQ correction from timber data.</p>
</dd></dl>

<dl class="py function">
<dt id="omc3.amplitude_detuning_analysis.get_approx_bbq_interval">
<code class="sig-prename descclassname">omc3.amplitude_detuning_analysis.</code><code class="sig-name descname">get_approx_bbq_interval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bbq_df</span></em>, <em class="sig-param"><span class="n">time_array</span></em>, <em class="sig-param"><span class="n">window_length</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/amplitude_detuning_analysis.html#get_approx_bbq_interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.amplitude_detuning_analysis.get_approx_bbq_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Get data in approximate time interval,
for averaging based on window length and kick interval</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-omc3.madx_wrapper">
<span id="mad-x"></span><h2>MAD-X<a class="headerlink" href="#module-omc3.madx_wrapper" title="Permalink to this headline">¶</a></h2>
<div class="section" id="entrypoint-madx-wrapper">
<h3>Entrypoint madx_wrapper<a class="headerlink" href="#entrypoint-madx-wrapper" title="Permalink to this headline">¶</a></h3>
<p>Runs MADX with a file or a string as an input.
If defined, writes the processed MADX script and logging output into files.</p>
<dl class="simple">
<dt>Usage:</dt><dd><p>python madx_wrapper.py --file your_madx_file.madx</p>
</dd>
</dl>
<dl class="py exception">
<dt id="omc3.madx_wrapper.MadxError">
<em class="property">exception </em><code class="sig-prename descclassname">omc3.madx_wrapper.</code><code class="sig-name descname">MadxError</code><a class="reference internal" href="../_modules/omc3/madx_wrapper.html#MadxError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.madx_wrapper.MadxError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="omc3.madx_wrapper.run_file">
<code class="sig-prename descclassname">omc3.madx_wrapper.</code><code class="sig-name descname">run_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_file</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">madx_path</span><span class="o">=</span><span class="default_value">'/home/travis/build/pylhc/omc3/omc3/bin/madx-linux64-gnu'</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/madx_wrapper.html#run_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.madx_wrapper.run_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs MADX in a subprocess.</p>
<dl class="py attribute">
<dt id="omc3.madx_wrapper.input_file">
<code class="sig-prename descclassname">omc3.madx_wrapper.</code><code class="sig-name descname">input_file</code><a class="headerlink" href="#omc3.madx_wrapper.input_file" title="Permalink to this definition">¶</a></dt>
<dd><p>MADX input file</p>
</dd></dl>

<dl class="py attribute">
<dt id="omc3.madx_wrapper.output_file">
<code class="sig-prename descclassname">omc3.madx_wrapper.</code><code class="sig-name descname">output_file</code><a class="headerlink" href="#omc3.madx_wrapper.output_file" title="Permalink to this definition">¶</a></dt>
<dd><p>If given writes MADX script.</p>
</dd></dl>

<dl class="py attribute">
<dt id="omc3.madx_wrapper.log_file">
<code class="sig-prename descclassname">omc3.madx_wrapper.</code><code class="sig-name descname">log_file</code><a class="headerlink" href="#omc3.madx_wrapper.log_file" title="Permalink to this definition">¶</a></dt>
<dd><p>If given writes MADX logging output.</p>
</dd></dl>

<dl class="py attribute">
<dt id="omc3.madx_wrapper.madx_path">
<code class="sig-prename descclassname">omc3.madx_wrapper.</code><code class="sig-name descname">madx_path</code><a class="headerlink" href="#omc3.madx_wrapper.madx_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to MADX executable</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="omc3.madx_wrapper.run_string">
<code class="sig-prename descclassname">omc3.madx_wrapper.</code><code class="sig-name descname">run_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_string</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">madx_path</span><span class="o">=</span><span class="default_value">'/home/travis/build/pylhc/omc3/omc3/bin/madx-linux64-gnu'</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/madx_wrapper.html#run_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.madx_wrapper.run_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs MADX in a subprocess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_string</strong> -- MADX input string</p></li>
<li><p><strong>output_file</strong> -- If given writes MADX script.</p></li>
<li><p><strong>log_file</strong> -- If given writes MADX logging output.</p></li>
<li><p><strong>madx_path</strong> -- Path to MADX executable</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-omc3.tbt_converter">
<span id="converter"></span><h2>Converter<a class="headerlink" href="#module-omc3.tbt_converter" title="Permalink to this headline">¶</a></h2>
<div class="section" id="entrypoint-tbt-converter">
<h3>Entrypoint tbt_converter<a class="headerlink" href="#entrypoint-tbt-converter" title="Permalink to this headline">¶</a></h3>
<p>Created on 29/08/19</p>
<dl class="field-list simple">
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lukas Malina</p>
</dd>
</dl>
<dl class="simple">
<dt>Top-level script, which converts turn-by-turn files from various formats to LHC binary SDDS files.</dt><dd><p>Optionally, it can replicate files with added noise.</p>
</dd>
</dl>
<dl class="py function">
<dt id="omc3.tbt_converter.converter_entrypoint">
<code class="sig-prename descclassname">omc3.tbt_converter.</code><code class="sig-name descname">converter_entrypoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/tbt_converter.html#converter_entrypoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.tbt_converter.converter_entrypoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts turn-by-turn files from various formats to LHC binary SDDS files.
Optionally can replicate files files with added noise.</p>
<dl>
<dt>Converter Kwargs:</dt><dd><ul>
<li><p><strong>files</strong>: TbT files to convert</p>
<p>Flags: <strong>--files</strong>
Required: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p><strong>outputdir</strong>: Output directory.</p>
<p>Flags: <strong>--outputdir</strong>
Required: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p><strong>tbt_datatype</strong> <em>(str)</em>: Choose datatype from which to import (e.g LHC binary SDDS).</p>
<p>Flags: <strong>--tbt_datatype</strong>
Default: <code class="docutils literal notranslate"><span class="pre">lhc</span></code></p>
</li>
<li><p><strong>realizations</strong> <em>(int)</em>: Number of copies with added noise.</p>
<p>Flags: <strong>--realizations</strong>
Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</li>
<li><p><strong>noise_levels</strong> <em>(float)</em>: Sigma of added Gaussian noise.</p>
<p>Flags: <strong>--noise_levels</strong>
Default: None</p>
</li>
<li><p><strong>use_average</strong> <em>(bool)</em>: If set, returned sdds only contains the average over all particle/bunches.</p>
<p>Flags: <strong>--use_average</strong>
Default: False</p>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-omc3.plotting.plot_optics_measurements">
<span id="plotting"></span><h2>Plotting<a class="headerlink" href="#module-omc3.plotting.plot_optics_measurements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="plot-optics-measurements">
<h3>Plot Optics Measurements<a class="headerlink" href="#plot-optics-measurements" title="Permalink to this headline">¶</a></h3>
<p>Wrapper for <cite>plot_tfs</cite> to easily plot the results from optics measurements.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">omc3.plotting.plot_optics_measurements</span> <span class="kn">import</span> <span class="n">plot</span>

<span class="n">figs</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span>
    <span class="n">folders</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;folder1&#39;</span><span class="p">,</span> <span class="s1">&#39;folder2&#39;</span><span class="p">],</span>
    <span class="n">combine_by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">],</span>  <span class="c1"># to compare folder1 and folder2</span>
    <span class="n">output</span><span class="o">=</span><span class="s1">&#39;output_directory&#39;</span><span class="p">,</span>
    <span class="n">delta</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># delta from reference</span>
    <span class="n">optics_parameters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;orbit&#39;</span><span class="p">,</span> <span class="s1">&#39;beta_phase&#39;</span><span class="p">,</span> <span class="s1">&#39;beta_amplitude&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="s1">&#39;total_phase&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;f1001_x&#39;</span><span class="p">,</span> <span class="s1">&#39;f1010_x&#39;</span><span class="p">],</span>
    <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;location&#39;</span><span class="p">,</span>  <span class="c1"># or &#39;phase-advance&#39;</span>
    <span class="n">ip_positions</span><span class="o">=</span><span class="s1">&#39;LHCB1&#39;</span><span class="p">,</span>
    <span class="n">suppress_column_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ncol_legend</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul class="simple">
<li><p><strong>folders</strong> <em>(MultiClass)</em>: Optics Measurements folders containing the analysed data.</p></li>
<li><p><strong>optics_parameters</strong> <em>(str)</em>: Optics parameters to plot, e.g. ‘beta_amplitude’.
RDTs need to be specified with plane, e.g. ‘f1001_x’</p></li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>change_marker</strong>: Changes marker for each line in the plot.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>combine_by</strong>: Combine plots into one. Either files, planes (not separated into two axes) or both.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['files',</span> <span class="pre">'planes']</span></code></p>
</li>
<li><p><strong>delta</strong>: Plot the difference to model instead of the parameter.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>errorbar_alpha</strong> <em>(float)</em>: Alpha value for error bars</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">0.6</span></code></p>
</li>
<li><p><strong>ip_positions</strong>: Input to plot IP-Positions into the plots. Either ‘LHCB1’
or ‘LHCB2’ for LHC defaults, a dictionary of labels and positions or path to TFS file of a model.</p></li>
<li><p><strong>ip_search_pattern</strong>: In case your IPs have a weird name. Specify regex pattern.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">IP\d$</span></code></p>
</li>
<li><p><strong>lines_manual</strong> <em>(DictAsString)</em>: List of manual lines to plot.
Need to contain arguments for axvline, and may contain the additional keys “text”
and “loc” which is one of [‘bottom’, ‘top’, ‘line bottom’, ‘line top’]
and places the text at the given location.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
</li>
<li><p><strong>manual_style</strong> <em>(DictAsString)</em>: Additional style rcParameters which
update the set of predefined ones.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code></p>
</li>
<li><p><strong>ncol_legend</strong> <em>(int)</em>: Number of bpm legend-columns. If &lt; 1 no legend is shown.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">3</span></code></p>
</li>
<li><p><strong>output</strong> <em>(MultiClass)</em>: Folder to output the results to.</p></li>
<li><p><strong>plot_styles</strong> <em>(str)</em>: Which plotting styles to use,
either from plotting.styles.*.mplstyles or default mpl.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">['standard']</span></code></p>
</li>
<li><p><strong>share_xaxis</strong>: In case of multiple axes per figure, share x-axis.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>show</strong>: Shows plots.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>suppress_column_legend</strong>: Does not show column name in legend
e.g. when combining by files (see also <cite>ncol_legend</cite>).</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>x_axis</strong>: Which parameter to use for the x axis.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['location',</span> <span class="pre">'phase-advance']</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">location</span></code></p>
</li>
<li><p><strong>x_lim</strong> <em>(float, int, None)</em>: Limits on the x axis (Tupel)</p></li>
<li><p><strong>y_lim</strong> <em>(float, int, None)</em>: Limits on the y axis (Tupel)</p></li>
</ul>
<dl class="py function">
<dt id="omc3.plotting.plot_optics_measurements.plot">
<code class="sig-prename descclassname">omc3.plotting.plot_optics_measurements.</code><code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/plotting/plot_optics_measurements.html#plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.plotting.plot_optics_measurements.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Main plotting function.</p>
</dd></dl>

</div>
<span class="target" id="module-omc3.plotting.plot_tfs"></span><div class="section" id="plot-tfs">
<h3>Plot TFS<a class="headerlink" href="#plot-tfs" title="Permalink to this headline">¶</a></h3>
<p>Easily plot tfs-files with all kinds of additional functionality and ways to
combine plots.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">omc3.plotting.plot_tfs</span> <span class="kn">import</span> <span class="n">plot</span>

<span class="n">figs</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span>
    <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;beta_phase_</span><span class="si">{0}</span><span class="s1">.tfs&#39;</span><span class="p">,</span> <span class="s1">&#39;beta_amp_</span><span class="si">{0}</span><span class="s1">.tfs&#39;</span><span class="p">],</span>
    <span class="n">same_figure</span><span class="o">=</span><span class="s1">&#39;planes&#39;</span><span class="p">,</span>
    <span class="n">same_axes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">],</span>
    <span class="n">x_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">],</span>
    <span class="n">y_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BET</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="p">],</span>
    <span class="n">error_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">planes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">],</span>
    <span class="n">x_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location [m]&#39;</span><span class="p">],</span>
    <span class="n">file_labels</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\beta$ from phase&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$eta$ from amplitude&#39;</span><span class="p">],</span>
    <span class="c1"># column_labels=[r&#39;$\beta_{0}$&#39;],    # would have bx in legend</span>
    <span class="n">column_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>                  <span class="c1"># removes COLUMNX COLUMNY from legend-names</span>
    <span class="n">y_labels</span><span class="o">=</span><span class="p">[[</span><span class="sa">r</span><span class="s1">&#39;$\beta_x$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\beta_y$&#39;</span><span class="p">]],</span>  <span class="c1"># axes labels (outer = figures, inner = axes)</span>
    <span class="n">output</span><span class="o">=</span><span class="s1">&#39;output_dir&#39;</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">single_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">change_marker</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul class="simple">
<li><p><strong>files</strong> <em>(MultiClass)</em>: Path to files to plot.
If planes are used, replace the plane in the filename with ‘{0}’</p></li>
<li><p><strong>x_columns</strong> <em>(str)</em>: List of column names to use as x-values.</p></li>
<li><p><strong>y_columns</strong> <em>(str)</em>: List of column names to plot (e.g. BETX, BETY or BET{0} if <cite>planes</cite> is used.)</p></li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>change_marker</strong>: Changes marker for each line in the plot.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>column_labels</strong> <em>(str)</em>: Column-Labels for the plots, default: y_columns.</p></li>
<li><p><strong>error_columns</strong> <em>(str)</em>: List of parameters to get error values from.</p></li>
<li><p><strong>errorbar_alpha</strong> <em>(float)</em>: Alpha value for error bars</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">0.6</span></code></p>
</li>
<li><p><strong>file_labels</strong> <em>(str)</em>: Labels for the files, default: filenames.</p></li>
<li><p><strong>manual_style</strong> <em>(DictAsString)</em>: Additional style rcParameters which update the set of predefined ones.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code></p>
</li>
<li><p><strong>ncol_legend</strong> <em>(int)</em>: Number of bpm legend-columns. If &lt; 1 no legend is shown.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">3</span></code></p>
</li>
<li><p><strong>output</strong> <em>(MultiClass)</em>: Folder to output the plots to.</p></li>
<li><p><strong>output_prefix</strong> <em>(str)</em>: Prefix for the output filename.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">plot_</span></code></p>
</li>
<li><p><strong>planes</strong> <em>(str)</em>: Works only with filenames ending in ‘x’ and ‘y’ and columns ending in X or Y.
These suffixes will be attached to the given files and y_columns.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">('X',</span> <span class="pre">'Y')</span></code></p>
</li>
<li><p><strong>plot_styles</strong> <em>(str)</em>: Which plotting styles to use,
either from plotting.styles.*.mplstyles or default mpl.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">['standard']</span></code></p>
</li>
<li><p><strong>same_axes</strong> <em>(str)</em>: Combine plots into single axes. Multiple choices possible.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['files',</span> <span class="pre">'columns',</span> <span class="pre">'planes']</span></code></p>
</li>
<li><p><strong>same_figure</strong> <em>(str)</em>: Plot two axes into the same figure (can’t be the same as ‘same_axes’).
Has no effect if there is only one of the given thing.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['files',</span> <span class="pre">'columns',</span> <span class="pre">'planes']</span></code></p>
</li>
<li><p><strong>share_xaxis</strong>: In case of multiple axes per figure, share x-axis.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>show</strong>: Shows plots.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>single_legend</strong>: Show only one legend instance (at the top plot).</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>vertical_lines</strong> <em>(DictAsString)</em>: List of vertical lines (e.g. IR positions) to plot.
Need to contain arguments for axvline, and may contain the additional keys “text” and “loc”
which is one of  [‘bottom’, ‘top’, ‘line bottom’, ‘line top’] and places the text at the given location.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
</li>
<li><p><strong>x_labels</strong> <em>(str)</em>: Labels for the x-axis, default: x_columns.</p></li>
<li><p><strong>x_lim</strong> <em>(float, int, None)</em>: Limits on the x axis (Tupel)</p></li>
<li><p><strong>y_labels</strong>: Override labels for the y-axis, default: file_labels or column_labels (depending on same_axes).
Needs to be a list of lists, where the inner list goes over the axes in one figure and the outer over the figures.
If the respective length is 1, the same label will be used for all figures or axes.</p></li>
<li><p><strong>y_lim</strong> <em>(float, int None)</em>: Limits on the y axis (Tupel)</p></li>
</ul>
<dl class="py function">
<dt id="omc3.plotting.plot_tfs.get_id">
<code class="sig-prename descclassname">omc3.plotting.plot_tfs.</code><code class="sig-name descname">get_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename_parts</span></em>, <em class="sig-param"><span class="n">column</span></em>, <em class="sig-param"><span class="n">file_label</span></em>, <em class="sig-param"><span class="n">column_label</span></em>, <em class="sig-param"><span class="n">same_axes</span></em>, <em class="sig-param"><span class="n">same_figure</span></em>, <em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="n">plane</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">planes</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/plotting/plot_tfs.html#get_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.plotting.plot_tfs.get_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the right IDs for the current sorting way.</p>
<p>This is where the actual sorting happens, by mapping the right IDs according
to the chosen options.</p>
</dd></dl>

<dl class="py function">
<dt id="omc3.plotting.plot_tfs.plot">
<code class="sig-prename descclassname">omc3.plotting.plot_tfs.</code><code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/plotting/plot_tfs.html#plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.plotting.plot_tfs.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Main plotting function.</p>
</dd></dl>

<dl class="py function">
<dt id="omc3.plotting.plot_tfs.sort_data">
<code class="sig-prename descclassname">omc3.plotting.plot_tfs.</code><code class="sig-name descname">sort_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/plotting/plot_tfs.html#sort_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.plotting.plot_tfs.sort_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load all data from files and sort into figures</p>
</dd></dl>

</div>
<span class="target" id="module-omc3.plotting.plot_spectrum"></span><div class="section" id="plot-spectrum">
<h3>Plot Spectrum<a class="headerlink" href="#plot-spectrum" title="Permalink to this headline">¶</a></h3>
<p>Spectrum plotter for frequency analysis output-data (supports also DRIVE output).</p>
<p>The spectra can be either plotted as <cite>stem</cite>-plots or as <cite>waterfall</cite>-plots.
The stem-plots can be in any combination: split by given files, split by given
bpms or combined in any way (by usage of the <cite>combine_by</cite> option).
Note that if both of those are false (as is default)
there will anyway be only one waterfall plot per given input file.</p>
<p>In case of split-by-file, plots are saved in a sub-directory of
the given <cite>output_dir</cite> with the name of the original TbT file.
In case of split by bpm the plots will have the bpm-name in their filename.</p>
<p>The <cite>lines_tunes</cite> and <cite>lines_nattunes</cite> lists accept tuples of multipliers for
the respective tunes, which define the resonance lines plotted into the
spectrum as well. A dashed line will indicate the average of all tunes
given in the data of one figure, while a semi-transparent area will indicate
min- and max- values of this line.</p>
<p>With <cite>lines_manual</cite>, one can plot vertical lines at manual locations (see
parameter specs below).</p>
<p>The function returns two dictionaries, where the first dictionary contains the
stem plots and the second one the waterfall plots. They are identifyable
by unique id’s which depend on which combination of merging the spectra into
one figure is used.</p>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul class="simple">
<li><p><strong>files</strong>: List of paths to the spectrum files. The files need to be given
without their ‘.lin’/’.amps[xy]’,’.freqs[xy]’ endings. (So usually the path
of the TbT-Data file.)</p></li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>amp_limit</strong> <em>(float)</em>: All amplitudes &lt;= limit are filtered.
This value needs to be at least 0 to filter non-found frequencies.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code></p>
</li>
<li><p><strong>bpms</strong>: List of BPMs for which spectra will be plotted. If not given all BPMs are used.</p></li>
<li><p><strong>combine_by</strong>: Choose how to combine the data into figures.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['bpms',</span> <span class="pre">'files']</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
</li>
<li><p><strong>filetype</strong> <em>(str)</em>: Filetype to save plots as (i.e. extension without “.”)</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">pdf</span></code></p>
</li>
<li><p><strong>lines_manual</strong> <em>(DictAsString)</em>: List of manual lines to plot. Need to contain arguments for axvline,
and may contain the additional key “loc” which is one of [‘bottom’, ‘top’, ‘line bottom’, ‘line top’]
and places the label as text at the given location.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
</li>
<li><p><strong>lines_nattunes</strong> <em>(tuple)</em>: List of natural tune lines to plot</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">0),</span> <span class="pre">(0,</span> <span class="pre">1)]</span></code></p>
</li>
<li><p><strong>lines_tunes</strong> <em>(tuple)</em>: list of tune lines to plot</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">0),</span> <span class="pre">(0,</span> <span class="pre">1)]</span></code></p>
</li>
<li><p><strong>manual_style</strong> <em>(DictAsString)</em>: Additional Style parameters which update the set of predefined ones.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code></p>
</li>
<li><p><strong>ncol_legend</strong> <em>(int)</em>: Number of bpm legend-columns. If &lt; 1 no legend is shown.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</li>
<li><p><strong>output_dir</strong> <em>(str)</em>: Directory to write results to. If no option is given, plots will not be saved.</p></li>
<li><p><strong>plot_type</strong>: Choose plot type (Multiple choices possible).</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['stem',</span> <span class="pre">'waterfall']</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">['stem']</span></code></p>
</li>
<li><p><strong>rescale</strong>: Flag to rescale plots amplitude to max-line = 1</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>show_plots</strong>: Flag to show plots</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>waterfall_cmap</strong> <em>(str)</em>: Colormap to use for waterfall plot.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">inferno</span></code></p>
</li>
<li><p><strong>waterfall_common_plane_colors</strong>: Same colorbar scale for both planes in waterfall plots.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>waterfall_line_width</strong>: Line width of the waterfall frequency lines. “auto” fills them up until the next one.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</li>
<li><p><strong>xlim</strong> <em>(float)</em>: Limits on the x axis (Tupel)</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0.5]</span></code></p>
</li>
<li><p><strong>ylim</strong> <em>(float)</em>: Limits on the y axis (Tupel)</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[1e-09,</span> <span class="pre">1.0]</span></code></p>
</li>
</ul>
<dl class="py function">
<dt id="omc3.plotting.plot_spectrum.get_reshuffled_tab20c">
<code class="sig-prename descclassname">omc3.plotting.plot_spectrum.</code><code class="sig-name descname">get_reshuffled_tab20c</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/plotting/plot_spectrum.html#get_reshuffled_tab20c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.plotting.plot_spectrum.get_reshuffled_tab20c" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshuffel tab20c so that the colors change between next lines.
Needs to be up here as it is used in DEFAULTS which is loaded early.</p>
</dd></dl>

</div>
<span class="target" id="module-omc3.plotting.plot_amplitude_detuning"></span><div class="section" id="plot-amplitude-detuning-results">
<h3>Plot Amplitude Detuning Results<a class="headerlink" href="#plot-amplitude-detuning-results" title="Permalink to this headline">¶</a></h3>
<p>Provides the plotting function for amplitude detuning analysis</p>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul>
<li><p><strong>kicks</strong>: Kick files as data frames or tfs files.</p></li>
<li><p><strong>labels</strong> <em>(str)</em>: Labels for the data. Needs to be same length as kicks.</p></li>
<li><p><strong>plane</strong> <em>(str)</em>: Plane of the kicks.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">('X',</span> <span class="pre">'Y')</span></code></p>
</li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>action_plot_unit</strong> <em>(str)</em>: Unit the action should be plotted in.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['km',</span> <span class="pre">'m',</span> <span class="pre">'mm',</span> <span class="pre">'um',</span> <span class="pre">'nm',</span> <span class="pre">'pm',</span> <span class="pre">'fm',</span> <span class="pre">'am']</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">um</span></code></p>
</li>
<li><p><strong>action_unit</strong> <em>(str)</em>: Unit the action is given in.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['km',</span> <span class="pre">'m',</span> <span class="pre">'mm',</span> <span class="pre">'um',</span> <span class="pre">'nm',</span> <span class="pre">'pm',</span> <span class="pre">'fm',</span> <span class="pre">'am']</span></code>
Default: <code class="docutils literal notranslate"><span class="pre">m</span></code></p>
</li>
<li><p><strong>correct_acd</strong>: Correct for AC-Dipole kicks.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>detuning_order</strong> <em>(int)</em>: Order of the detuning as int. Basically just the order of the applied fit.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</li>
<li><p><strong>manual_style</strong> <em>(DictAsString)</em>: Additional plotting style.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code></p>
</li>
<li><p><strong>output</strong> <em>(str)</em>: Save the amplitude detuning plot here.</p></li>
<li><p><strong>show</strong>: Show the amplitude detuning plot.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>tune_scale</strong> <em>(int)</em>: Plotting exponent of the tune.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">-3</span></code></p>
</li>
<li><p><strong>x_lim</strong> <em>(float)</em>: Action limits in um (x-axis).</p></li>
<li><p><strong>y_lim</strong> <em>(float)</em>: Tune limits in units of tune scale (y-axis).</p></li>
</ul>
<dl class="py function">
<dt id="omc3.plotting.plot_amplitude_detuning.plot_odr">
<code class="sig-prename descclassname">omc3.plotting.plot_amplitude_detuning.</code><code class="sig-name descname">plot_odr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">odr_fit</span></em>, <em class="sig-param"><span class="n">xmax</span></em>, <em class="sig-param"><span class="n">action_unit</span></em>, <em class="sig-param"><span class="n">tune_scale</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/plotting/plot_amplitude_detuning.html#plot_odr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.plotting.plot_amplitude_detuning.plot_odr" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a quadratic odr fit to axes.</p>
</dd></dl>

</div>
<span class="target" id="module-omc3.plotting.plot_bbq"></span><div class="section" id="plot-bbq">
<h3>Plot BBQ<a class="headerlink" href="#plot-bbq" title="Permalink to this headline">¶</a></h3>
<p>Provides the plotting function for the extracted and cleaned BBQ data from timber.</p>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul>
<li><p><strong>input</strong>: BBQ data as data frame or tfs file.</p>
<p>Flags: <strong>--in</strong></p>
</li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>interval</strong> <em>(float)</em>: x_axis interval that was used in calculations.</p>
<p>Flags: <strong>--interval</strong></p>
</li>
<li><p><strong>kick</strong>: Kick file as data frame or tfs file.</p></li>
<li><p><strong>output</strong> <em>(str)</em>: Save figure to this location.</p>
<p>Flags: <strong>--out</strong></p>
</li>
<li><p><strong>show</strong>: Show plot.</p>
<p>Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>two_plots</strong>: Plot two axis into the figure.</p>
<p>Flags: <strong>--two</strong>
Action: <code class="docutils literal notranslate"><span class="pre">store_true</span></code></p>
</li>
<li><p><strong>x_lim</strong> <em>(float)</em>: X-Axis limits. (yyyy-mm-dd HH:mm:ss.mmm)</p></li>
<li><p><strong>y_lim</strong> <em>(float)</em>: Y-Axis limits.</p></li>
</ul>
<dl class="py function">
<dt id="omc3.plotting.plot_bbq.main">
<code class="sig-prename descclassname">omc3.plotting.plot_bbq.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/plotting/plot_bbq.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.plotting.plot_bbq.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot BBQ wrapper.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-omc3.scripts.merge_kmod_results">
<span id="scripts"></span><h2>Scripts<a class="headerlink" href="#module-omc3.scripts.merge_kmod_results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="merge-kmod-results">
<h3>Merge KMOD Results<a class="headerlink" href="#merge-kmod-results" title="Permalink to this headline">¶</a></h3>
<p>Script to merge the results from KMOD into one TfsDataFrame.
The script takes the kmod-results folders as input and merges the
lsa-result tfs-files in these together.</p>
<p>The resulting TfsDataFrame is returned, but also written out if an <cite>outputdir</cite>
is given.</p>
<p>BPMWKs (common for both beams) are hereby dropped, to avoid duplicated elements.</p>
<p>Headers of the same name will be overwritten (depending on the alphabetical
order of the directory names).</p>
<p>Some sanity checks are performed, e.g. that there is only one entry per element.
If IP1 and IP5 results are given for both planes and beams, the luminosity
imbalance between these IPs is also calculated and written into the header,
as well as logged.</p>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul>
<li><p><strong>kmod_dirs</strong> <em>(Path)</em>:</p>
<blockquote>
<div><p>Path to kmod directories with stored KMOD measurement files,in particular lsa_results.tfs</p>
</div></blockquote>
</li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>outputdir</strong> <em>(Path)</em>:</p>
<blockquote>
<div><p>Output directory where to write the result tfs</p>
</div></blockquote>
</li>
</ul>
<dl class="py function">
<dt id="omc3.scripts.merge_kmod_results.get_kmod_ip_subdirs">
<code class="sig-prename descclassname">omc3.scripts.merge_kmod_results.</code><code class="sig-name descname">get_kmod_ip_subdirs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kmod_dirs</span><span class="p">:</span> <span class="n">List<span class="p">[</span>pathlib.Path<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>pathlib.Path<span class="p">]</span><a class="reference internal" href="../_modules/omc3/scripts/merge_kmod_results.html#get_kmod_ip_subdirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.scripts.merge_kmod_results.get_kmod_ip_subdirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the paths to the ip-subdirectories in the kmod result directories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kmod_dirs</strong> (<em>List</em><em>[</em><em>Path</em><em>]</em>) -- Main kmod result directories with IP-subdirectories</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(List[Path]) Paths to all subdirectories.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="omc3.scripts.merge_kmod_results.get_lumi_imbalance">
<code class="sig-prename descclassname">omc3.scripts.merge_kmod_results.</code><code class="sig-name descname">get_lumi_imbalance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_frame</span><span class="p">:</span> <span class="n">tfs.handler.TfsDataFrame</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>uncertainties.core.AffineScalarFunc<span class="p">, </span>uncertainties.core.AffineScalarFunc<span class="p">, </span>uncertainties.core.AffineScalarFunc<span class="p">]</span><a class="reference internal" href="../_modules/omc3/scripts/merge_kmod_results.html#get_lumi_imbalance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.scripts.merge_kmod_results.get_lumi_imbalance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the IP1 / IP5 luminosity imbalance. The luminosity is taken as defined in
<cite>Concept of luminosity</cite>, Eq(17): <a class="reference external" href="https://cds.cern.ch/record/941318/files/p361.pdf">https://cds.cern.ch/record/941318/files/p361.pdf</a></p>
<p>The calculation of the luminosity imbalance is then:</p>
<div class="math notranslate nohighlight">
\[\frac{L_{IP1}}{L_{IP5}}=\frac{\sqrt{\beta_{x1,IP5}+\beta_{x2,IP5}}
\cdot\sqrt{\beta_{y1,IP5}+\beta_{y2,IP5}}}
{\sqrt{\beta_{x1,IP1}+\beta_{x2,IP1}}\cdot\sqrt{\beta_{y1,IP1}+\beta_{y2,IP1}}}\]</div>
<p>and the error:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\sigma_{\frac{L_{IP1}}{L_{IP5}}} = \frac{1}{2}\frac{L_{IP1}}{L_{IP5}}
\cdot \sqrt{\sum_{\substack{z \in (x,y) \\ i \in (IP1, IP5) }}
{\frac{\sigma^2_{\beta_{z1,i}} + \sigma^2_{\beta_{z2,i}}} {(\beta_{z1,i}+\beta_{z2,i})^2}}}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_frame</strong> (<em>tfs.TfsDataFrame</em>) -- a <cite>TfsDataFrame</cite> with the results from a kmod analysis.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple with the imbalance, the betas at IPs as ufloats.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="omc3.scripts.merge_kmod_results.merge_kmod_results">
<code class="sig-prename descclassname">omc3.scripts.merge_kmod_results.</code><code class="sig-name descname">merge_kmod_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">opt</span></em><span class="sig-paren">)</span> &#x2192; tfs.handler.TfsDataFrame<a class="reference internal" href="../_modules/omc3/scripts/merge_kmod_results.html#merge_kmod_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.scripts.merge_kmod_results.merge_kmod_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function to merge K-Mod output.
See <a class="reference internal" href="#module-omc3.scripts.merge_kmod_results" title="omc3.scripts.merge_kmod_results"><code class="xref py py-mod docutils literal notranslate"><span class="pre">omc3.scripts.merge_kmod_results</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt id="omc3.scripts.merge_kmod_results.merge_tfs">
<code class="sig-prename descclassname">omc3.scripts.merge_kmod_results.</code><code class="sig-name descname">merge_tfs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directories</span><span class="p">:</span> <span class="n">List<span class="p">[</span>pathlib.Path<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; tfs.handler.TfsDataFrame<a class="reference internal" href="../_modules/omc3/scripts/merge_kmod_results.html#merge_tfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#omc3.scripts.merge_kmod_results.merge_tfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge different kmod analysis results from a list of directories into a single <cite>TfsDataFrame</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directories</strong> (<em>List</em><em>[</em><em>pathlib.Path</em><em>]</em>) -- list of PosixPath objects to directories holding TFS
files with the results of kmod analysis.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) -- name of the TFS files to look for in the provided directories</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <cite>TfsDataFrame</cite> combining all the loaded files from the provided directories.</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-omc3.scripts.update_nattune_in_linfile"></span><div class="section" id="update-natural-tune-in-lin-files">
<h3>Update Natural Tune in Lin-Files<a class="headerlink" href="#update-natural-tune-in-lin-files" title="Permalink to this headline">¶</a></h3>
<p>Script to update the natural tune in lin files, based on the spectrum data
(amps and freqs) and a given frequency interval.</p>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul>
<li><p><strong>files</strong>:</p>
<blockquote>
<div><p>List of paths to the spectrum files.
The files need to be given without their ‘.lin’/’.amps[xy]’,’.freqs[xy]’ endings.
(So usually the path of the TbT-Data file.)</p>
</div></blockquote>
</li>
<li><p><strong>interval</strong> <em>(float)</em>:</p>
<blockquote>
<div><p>Frequency interval in which the highest peak should be found.</p>
</div></blockquote>
</li>
</ul>
<p><em>--Optional--</em></p>
<ul>
<li><p><strong>bpms</strong>:</p>
<blockquote>
<div><p>List of BPMs which need to be updated. If not given it will be all of them.</p>
</div></blockquote>
</li>
<li><p><strong>not_found_action</strong> <em>(str)</em>:</p>
<blockquote>
<div><p>Defines what to do, if no line was found in given interval.
‘error’: throws a ValueError; ‘remove’: removes the bpm; ‘ignore’: keeps the old values.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">['error',</span> <span class="pre">'remove',</span> <span class="pre">'ignore']</span></code></p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">error</span></code></p>
</div></blockquote>
</li>
<li><p><strong>planes</strong> <em>(str)</em>:</p>
<blockquote>
<div><p>Which planes.</p>
<p>Choices: <code class="docutils literal notranslate"><span class="pre">('X',</span> <span class="pre">'Y')</span></code></p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">['X',</span> <span class="pre">'Y']</span></code></p>
</div></blockquote>
</li>
<li><p><strong>rename_suffix</strong> <em>(str)</em>:</p>
<blockquote>
<div><p>Additional suffix for output lin-file.
Will be inserted between filename and extension.
If empty, the original file is overwritten - unless they are old files,
then the omc3 filename convention will be used.</p>
<p>Default: <code class="docutils literal notranslate"><span class="pre">(empty</span> <span class="pre">string)</span></code></p>
</div></blockquote>
</li>
</ul>
</div>
<span class="target" id="module-omc3.scripts.write_madx_macros"></span><div class="section" id="write-mad-x-macros">
<h3>Write MAD-X Macros<a class="headerlink" href="#write-mad-x-macros" title="Permalink to this headline">¶</a></h3>
<p>Write out madx scripts for the tracking macros.</p>
<p><strong>Arguments:</strong></p>
<p><em>--Required--</em></p>
<ul>
<li><p><strong>outputdir</strong>:</p>
<blockquote>
<div><p>Directory where the observation_points.def will be put.</p>
</div></blockquote>
</li>
<li><p><strong>twissfile</strong>:</p>
<blockquote>
<div><p>Path to twissfile with observationspoint in the NAME column.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../definitions/index.html" class="btn btn-neutral float-right" title="Definitions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to omc3’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>