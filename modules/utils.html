

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Utils &mdash; omc3 0.20.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=449bdd91" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=82d4eb07"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Tune Analysis" href="tune_analysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/omc_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Main Entrypoints</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/analysis.html">Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/analysis.html#hole-in-one">Hole in One</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/analysis.html#amplitude-detuning-analysis">Amplitude Detuning Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/correction.html">Correction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/correction.html#global-correction">Global Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/correction.html#response-creator">Response Creator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/correction.html#correction-test">Correction Test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/other.html">Other</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/other.html#tbt-converter">TbT Converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/other.html#model-creator">Model Creator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/other.html#knob-extractor">Knob Extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/other.html#mad-x-wrapper">MAD-X Wrapper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/plotting.html">Plotting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/plotting.html#plot-optics-measurements">Plot Optics Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/plotting.html#plot-tfs">Plot TFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/plotting.html#plot-spectrum">Plot Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/plotting.html#plot-correction-test">Plot Correction Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/plotting.html#plot-amplitude-detuning-results">Plot Amplitude Detuning Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/plotting.html#plot-k-modulation-results">Plot K-Modulation Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/plotting.html#plot-bbq">Plot BBQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/scripts.html">Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#betabeat-src-output-converter">BetaBeat.src Output Converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#import-k-modulation-results">Import K-Modulation Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#k-mod-luminosity-imbalance">K-Mod Luminosity Imbalance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#update-natural-tune-in-lin-files">Update Natural Tune in Lin-Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#write-mad-x-macros">Write MAD-X Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#fake-measurement-from-model">Fake Measurement from Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#linfile-cleaning">Linfile Cleaning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/scripts.html#bad-bpms-summary">Bad BPMs Summary</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="correction.html">Correction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="correction.html#constants">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#handler">Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#model-appenders">Model Appenders</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#model-diff">Model Diff</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#response-mad-x">Response MAD-X</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#response-twiss">Response TWISS</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#sequence-evaluation">Sequence Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="correction.html#response-matrix-io">Response Matrix IO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Definitions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="definitions.html#constants">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="definitions.html#formats">Formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="harpy.html">Harpy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="harpy.html#clean">Clean</a></li>
<li class="toctree-l2"><a class="reference internal" href="harpy.html#constants">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="harpy.html#frequency">Frequency</a></li>
<li class="toctree-l2"><a class="reference internal" href="harpy.html#handler">Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="harpy.html#kicker">Kicker</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model.html#manager">Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#constants">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#accelerator">Accelerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#esrf">ESRF</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#lhc">LHC</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#ps">PS</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#ps-booster">PS Booster</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#superkekb">SuperKEKB</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#iota">Iota</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#petra">PETRA</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#lhc-model-creator">LHC Model Creator</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#ps-model-creator">PS Model Creator</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#ps-booster-model-creator">PS Booster Model Creator</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html#segment-creator">Segment Creator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="optics_measurements.html">Optics Measurements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#measure-optics">Measure Optics</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#beta-from-amplitude">Beta from Amplitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#beta-from-phase">Beta from Phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#chromatic">Chromatic</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#constants">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#combined-rdts">Combined RDTs</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#data-models">Data Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#dispersion">Dispersion</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#dpp">Dpp</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#isolation-forest">Isolation Forest</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#interaction-point">Interaction Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#kick">Kick</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#phase-advance">Phase Advance</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#resonance-driving-terms">Resonance Driving Terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#toolbox">Toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="optics_measurements.html#tune">Tune</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plot-Subfunctions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plotting.html#optics-measurements-plots">Optics Measurements Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html#spectrum-plots">Spectrum Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html#common-plot-functionality">Common Plot Functionality</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tune_analysis.html">Tune Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tune_analysis.html#constants">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="tune_analysis.html#bbq-tools">BBQ Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tune_analysis.html#fitting-tools">Fitting Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tune_analysis.html#kick-file-modifiers">Kick File Modifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="tune_analysis.html#timber-extraction">Timber Extraction</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#contexts">Contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#io-tools">IO Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logging-tools">Logging Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mock">Mock</a></li>
<li class="toctree-l2"><a class="reference internal" href="#outliers">Outliers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stats">Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#time-tools">Time Tools</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">omc3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Utils</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/pylhc/omc3" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <nav id="local-table-of-contents" role="navigation" aria-labelledby="local-table-of-contents-title">
    <h4 id="local-table-of-contents-title">On This Page</h4>
    <ul>
<li><a class="reference internal" href="#">Utils</a><ul>
<li><a class="reference internal" href="#contexts">Contexts</a></li>
<li><a class="reference internal" href="#io-tools">IO Tools</a></li>
<li><a class="reference internal" href="#logging-tools">Logging Tools</a></li>
<li><a class="reference internal" href="#mock">Mock</a></li>
<li><a class="reference internal" href="#outliers">Outliers</a></li>
<li><a class="reference internal" href="#stats">Stats</a></li>
<li><a class="reference internal" href="#time-tools">Time Tools</a></li>
</ul>
</li>
</ul>

  </nav>
  
  
           <div itemprop="articleBody">
             
  <section id="utils">
<h1>Utils<a class="headerlink" href="#utils" title="Link to this heading"></a></h1>
<section id="contexts">
<h2>Contexts<a class="headerlink" href="#contexts" title="Link to this heading"></a></h2>
<p>Provides contexts managers to use.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.contexts.</span></span><span class="sig-name descname"><span class="pre">log_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stdout=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stderr=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stderr&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/contexts.html#log_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Temporarily changes <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> and <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.contexts.</span></span><span class="sig-name descname"><span class="pre">silence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/contexts.html#silence"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Suppress all console output, rerouting <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> and <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code> to devnull.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.contexts.</span></span><span class="sig-name descname"><span class="pre">suppress_warnings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warning_classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/contexts.html#suppress_warnings"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Suppress all warnings of given classes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.contexts.</span></span><span class="sig-name descname"><span class="pre">timeit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/contexts.html#timeit"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Prints the time at the end of the context via <code class="docutils literal notranslate"><span class="pre">function</span></code>.</p>
</dd></dl>

<section id="io-tools">
<h2>IO Tools<a class="headerlink" href="#io-tools" title="Link to this heading"></a></h2>
<p>Helper functions for input/output issues.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">OptionalStr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#OptionalStr"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>A class that allows <cite>str</cite> or <cite>None</cite>.
Can be used in string-lists when individual entries can be <cite>None</cite>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">PathOrStr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#PathOrStr"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>A class that behaves like a Path when possible, otherwise like a string.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">PathOrStrOrDataFrame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#PathOrStrOrDataFrame"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>A class that behaves like a Path when possible, otherwise like a string.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">UnionPathStr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#UnionPathStr"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>A class that can be used as Path and string parser input, but does not convert to path.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">UnionPathStrInt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#UnionPathStrInt"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>A class that can be used as Path, string, int parser input, but does not convert.
Very special and used e.g. in the BBQ Input.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">always_true</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#always_true"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>A function that is always True.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">convert_paths_in_dict_to_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#convert_paths_in_dict_to_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Converts all Paths in the dict to strings, including those in iterables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">copy_content_of_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#copy_content_of_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Copies all files and directories from <code class="docutils literal notranslate"><span class="pre">src_dir</span></code> to <code class="docutils literal notranslate"><span class="pre">dst_dir</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">copy_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#copy_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Copies a file or a directory to <code class="docutils literal notranslate"><span class="pre">dest</span></code>, which may be a directory.
If <code class="docutils literal notranslate"><span class="pre">src_item</span></code> is a directory then all containing files and dirs will be copied into <code class="docutils literal notranslate"><span class="pre">dest</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">create_dirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path_to_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#create_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Creates all dirs to <code class="docutils literal notranslate"><span class="pre">path_to_dir</span></code> if not exists.
TODO: Change all calls to use only Path.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">get_check_suffix_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#get_check_suffix_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns a function that checks the suffix of a given path agains
the suffix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">glob_regex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#glob_regex"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Do a glob on the given <cite>path</cite> based on the regular expression <cite>pattern</cite>.
Returns only the matching filenames (as strings).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Path</em>) -- Folder path to look in.</p></li>
<li><p><strong>pattern</strong> (<em>str</em>) -- Pattern to match.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matching filenames</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterator[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">maybe_add_command</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">script</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#maybe_add_command"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Add a comment ‘;command’ to the opt-dict,
which is the command used to run the script gotten from sys.argv,
but only if the executed file (the file that run with the <cite>python</cite> command)
equals <code class="docutils literal notranslate"><span class="pre">script</span></code>, i.e. the script for which you are saving the parameters
is the main script being run. Otherwise the command is probably unrelated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opt</strong> (<em>dict</em>) -- Options datastructure</p></li>
<li><p><strong>script</strong> (<em>str</em>) -- Name of the script that called save_config.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated dict with ;command entry, or
if the script names were different, just the original opt.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">remove_none_dict_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#remove_none_dict_entries"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Removes <code class="docutils literal notranslate"><span class="pre">None</span></code> entries from dict. This can be used as a workaround to
<a class="reference external" href="https://github.com/pylhc/generic_parser/issues/26">https://github.com/pylhc/generic_parser/issues/26</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">replace_in_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#replace_in_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Replace a part of a path with a new path.
Useful for example to replace the original path with a path to a symlink or vice versa.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Path</em>) -- Path object to replace the subpath in</p></li>
<li><p><strong>old</strong> (<em>Union</em><em>[</em><em>Path</em><em>, </em><em>str</em><em>]</em>) -- Subpath to be replaced</p></li>
<li><p><strong>new</strong> (<em>Union</em><em>[</em><em>Path</em><em>, </em><em>str</em><em>]</em>) -- Subpath to replace with</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New Path object with the replacement in.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">save_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">script</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_opt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#save_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Quick wrapper for <code class="docutils literal notranslate"><span class="pre">save_options_to_config</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>Path</em>) -- Path to the output directory (does not need to exist).</p></li>
<li><p><strong>opt</strong> (<em>dict</em>) -- opt-structure to be saved.</p></li>
<li><p><strong>script</strong> (<em>str</em>) -- path/name of the invoking script (becomes name of the .ini) usually
<code class="docutils literal notranslate"><span class="pre">__file__</span></code>.</p></li>
<li><p><strong>unknown_opt</strong> (<em>dict</em><em>|</em><em>list</em>) -- un-parsed opt-structure to be saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.iotools.</span></span><span class="sig-name descname"><span class="pre">strip_quotes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/omc3/utils/iotools.html#strip_quotes"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Strip quotes around string-objects. If not a string, nothing
is changed. This is because the input from commandline or json files
could be surrounded by quotes (if they are strings).
The dict-parser removes them automatically as well.
This behaviour is important for basically every string-faker!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Any</em>) -- The input value that goes into the function.
Can be of any type.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If the input was a string, then it will be the string with stripped
quotes (if there were any). Otherwise just the value.</p>
</dd>
</dl>
</dd></dl>

<section id="logging-tools">
<h2>Logging Tools<a class="headerlink" href="#logging-tools" title="Link to this heading"></a></h2>
<p>Functions for easier use of logging, like automatic logger setup
(see: <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_logger()</span></code>).</p>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">DebugMode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#DebugMode"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Context Manager for the debug mode.
Hint: Does not work with <code class="docutils literal notranslate"><span class="pre">&#64;contextmanager</span></code> from contextlib (even though nicer code),
as the <code class="docutils literal notranslate"><span class="pre">_get_caller</span></code> would find <strong>contextlib.py</strong>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>active</strong> (<em>bool</em>) -- Defines if this manager is doing anything. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>log_file</strong> (<em>str</em>) -- File to log into.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">MaxFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#MaxFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>To get messages only up to a certain level.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">TempFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#TempFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Context Manager. Lets another function write into a temporary file and logs its contents.
It won’t open the file, so only the files path is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) -- Place to write the tempfile to.</p></li>
<li><p><strong>log_func</strong> (<em>func</em>) -- The function with which the content should be logged (e.g. LOG.info).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">TempStringLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#TempStringLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Temporarily log into a string that can be retrieved by <code class="docutils literal notranslate"><span class="pre">get_log</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> -- module to log, defaults to the caller file.</p></li>
<li><p><strong>level</strong> -- logging level, defaults to <code class="docutils literal notranslate"><span class="pre">INFO</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_log</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#TempStringLogger.get_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get the log as string.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">add_module_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#add_module_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Add handler at current module level.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">add_root_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#add_root_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Add handler at root level.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">file_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%(levelname)7s</span> <span class="pre">|</span> <span class="pre">%(message)s</span> <span class="pre">|</span> <span class="pre">%(name)s'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#file_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convenience function so the caller does not have to import logging.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">getLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#getLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convenience function so the caller does not have to import logging.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_console</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'%(levelname)7s</span> <span class="pre">|</span> <span class="pre">%(message)s</span> <span class="pre">|</span> <span class="pre">%(name)s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Sets up logger if name is <strong>__main__</strong>. Returns logger based on module name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> -- only used to check if __name__ is __main__.</p></li>
<li><p><strong>level_root</strong> -- main logging level, defaults to <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code>.</p></li>
<li><p><strong>level_console</strong> -- console logging level, defaults to <code class="docutils literal notranslate"><span class="pre">INFO</span></code>.</p></li>
<li><p><strong>fmt</strong> -- Format of the logging. For default see <code class="docutils literal notranslate"><span class="pre">BASIC_FORMAT</span></code>.</p></li>
<li><p><strong>color</strong> -- If <cite>None</cite> colors are used if tty is detected.
<cite>False</cite> will never use colors and <cite>True</cite> will always enforce them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Logger instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">get_my_logger_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#get_my_logger_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the logger name for the caller.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">list2str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#list2str"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Returns string representation of <code class="docutils literal notranslate"><span class="pre">list_</span></code>, but without brackets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">log_pandas_settings_with_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#log_pandas_settings_with_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Logs pandas <code class="docutils literal notranslate"><span class="pre">SettingsWithCopy</span></code> warning to loc_func instead of printing the warning.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">logging_silence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#logging_silence"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Remove temporarily all loggers from root logger.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">odr_pprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odr_out</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#odr_pprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Logs the odr output results. Adapted from odr_output pretty print.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">stream_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level=10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt='%(levelname)7s</span> <span class="pre">|</span> <span class="pre">%(message)s</span> <span class="pre">|</span> <span class="pre">%(name)s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_level=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#stream_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convenience function so the caller does not have to import logging.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.logging_tools.</span></span><span class="sig-name descname"><span class="pre">unformatted_console_logging</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/logging_tools.html#unformatted_console_logging"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Log only to console and only unformatted.</p>
</dd></dl>

<section id="mock">
<h2>Mock<a class="headerlink" href="#mock" title="Link to this heading"></a></h2>
<p>Provides mock functionality for packages necessitating the <code class="docutils literal notranslate"><span class="pre">CERN</span> <span class="pre">GPN</span></code> and only installable from the
<code class="docutils literal notranslate"><span class="pre">acc-py</span></code> package index, such as <code class="docutils literal notranslate"><span class="pre">pytimber</span></code>, <code class="docutils literal notranslate"><span class="pre">pjlsa</span></code> etc.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">omc3.utils.mock</span> <span class="kn">import</span> <span class="n">cern_network_import</span>
<span class="n">pytimber</span> <span class="o">=</span> <span class="n">cern_network_import</span><span class="p">(</span><span class="s2">&quot;pytimber&quot;</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">pytimber</span><span class="o">.</span><span class="n">LoggingDB</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;nxcals&quot;</span><span class="p">)</span>  <span class="c1"># will raise if pytimber not installed</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.mock.</span></span><span class="sig-name descname"><span class="pre">CERNNetworkMockPackage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/mock.html#CERNNetworkMockPackage"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Mock class to raise an error if the desired package functionality is called when the package is not
actually installed. Designed for packages installable only from inside the CERN network,
that are declared as <code class="docutils literal notranslate"><span class="pre">cern</span></code> extra. See module documentation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.mock.</span></span><span class="sig-name descname"><span class="pre">cern_network_import</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">package</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/mock.html#cern_network_import"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convenience function to try and import packages only available (and installable) on the CERN network.
If installed, the module is returned, otherwise a mock class is returned, which will raise an
insightful <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> on attempted use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>package</strong> (<em>str</em>) -- name of the package to try and import.</p>
</dd>
</dl>
</dd></dl>

<section id="outliers">
<h2>Outliers<a class="headerlink" href="#outliers" title="Link to this heading"></a></h2>
<p>Helper functions for outlier detection.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.outliers.</span></span><span class="sig-name descname"><span class="pre">get_filter_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/omc3/utils/outliers.html#get_filter_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Filters the array of values which are meant to be constant or a linear function of the x-data
array if that is provided, by checking how many sigmas they are deviating from the average.</p>
<p>The outlier filtering function is utilized at multiple stages of the data analysis.
It removes data points in the tails of the measured distribution,
which are too populated due to the finite sample size,
assuming a normal distribution specified by measured mean and standard
deviation of the given data.
A data point, outside of a user-specified limit,
is removed if there is less than a 50% chance
that it is from the specified normal distribution.</p>
<p>In particular:
The function gets an array <span class="math notranslate nohighlight">\(y\)</span> of data of length <span class="math notranslate nohighlight">\(n_y\)</span>,
which can be any scalar data and is currently used for e.g. tune data
measured per BPM or a time series from the BBQ.
In addition, a cleaning <code class="docutils literal notranslate"><span class="pre">limit</span></code> can be given,
inside which the data points are always kept.
Further an optional array <span class="math notranslate nohighlight">\(x\)</span> (via the parameter <code class="docutils literal notranslate"><span class="pre">x_data</span></code>)
can be given, in which case a linear fit <span class="math notranslate nohighlight">\(y = ax + c\)</span> is attempted
to remove any slope on the data, before calculating momenta on the data.
An upper boundary in <span class="math notranslate nohighlight">\(n_\sigma\)</span> is then determined from the
percent point function (ppf) of a Student’s t-distribution,
given <span class="math notranslate nohighlight">\(n_x\)</span> degrees of freedom at <span class="math notranslate nohighlight">\(100\% - 50\% / n_y\)</span>.
Iteratively, mean <span class="math notranslate nohighlight">\(\left&lt; y \right&gt;\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>
of the data is calculated and only data within <span class="math notranslate nohighlight">\(n_\sigma \cdot \sigma\)</span>,
or the given cleaning limit, around <span class="math notranslate nohighlight">\(\left&lt; y \right&gt;\)</span>
is kept for the next iteration. The loop stops either after 20 iterations,
when there is no more data outside the boundaries or
when there are less than three data points remaining.</p>
<p>Returns a filter mask for the original array (meaning <code class="docutils literal notranslate"><span class="pre">True</span></code> for elements that should be kept).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ArrayLike</em>) -- Data to filter.</p></li>
<li><p><strong>x_data</strong> (<em>ArrayLike</em>) -- Additional x-data. If given a linear function is fit on the data,
and the outliers filtered on the difference to this function.
Otherwise, the distribution of data is used directly for filtering.</p></li>
<li><p><strong>limit</strong> (<em>float</em>) -- Only data deviating more than this limit from the average is filtered.</p></li>
<li><p><strong>niter</strong> (<em>int</em>) -- Maximum number of filter iterations to do.
Iterations are interrupted if the number of datapoints did not shrink
in the last iteration or if there is only two or less data-points left.</p></li>
<li><p><strong>nsig</strong> (<em>int</em>) -- number of sigmas within the data points are considered okay, outside they are
considered outliers. If not given, nsigmas is got from the
1-0.5/length(data) percentile of a student-t distribution.</p></li>
<li><p><strong>mask</strong> (<em>ArrayLike</em>) -- Boolean mask of data-points to consider.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all data is considered.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Boolean array containing <code class="docutils literal notranslate"><span class="pre">True</span></code> entries for data-points that are good,</dt><dd><p>and <code class="docutils literal notranslate"><span class="pre">False</span></code> for the ones that should be filtered.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<section id="stats">
<h2>Stats<a class="headerlink" href="#stats" title="Link to this heading"></a></h2>
<p>Helper module providing statistical methods to compute various weighted averages along specified
axis and their errors as well as unbiased error estimator of infinite normal distribution from
finite-sized sample.</p>
<ul class="simple">
<li><p>TODO: use weighted average and its error in circular calculations</p></li>
<li><p>TODO: write tests</p></li>
<li><p>TODO: LOGGER or Raising error and warnings?</p></li>
<li><p>TODO: if zeros or nans occur in errors, fallback to uniform weights only in affected cases</p></li>
</ul>
</section>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">circular_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_value_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#circular_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes error of weighted circular average along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like
Contains the data to be averaged</p></li>
<li><p><strong>period</strong> -- scalar, optional
Periodicity period of data, default is (2 * np.pi)</p></li>
<li><p><strong>errors</strong> -- array-like, optional
Contains errors associated with the values in data, it is used to calculated weights</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which to average data</p></li>
<li><p><strong>t_value_corr</strong> -- bool, optional
Species if the error is corrected for small sample size, default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the error of weighted circular average along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">circular_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#circular_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes weighted circular average along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like
Contains the data to be averaged</p></li>
<li><p><strong>period</strong> -- scalar, optional, default (2 * np.pi)
Periodicity period of data</p></li>
<li><p><strong>errors</strong> -- array-like, optional
Contains errors associated with the values in data, it is used to calculated weights</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which to average data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the weighted circular average along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">circular_nanerror</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_value_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#circular_nanerror"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>“Wrapper around circular_error with added nan handling</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">circular_nanmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#circular_nanmean"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>“Wrapper around circular_mean with added nan handling</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">circular_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#circular_rms"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes the circular root mean square along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like
Contains the data to be averaged</p></li>
<li><p><strong>period</strong> -- scalar, optional
Periodicity period of data, default is (2 * np.pi)</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which to average data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the circular root mean square along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">effective_sample_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#effective_sample_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes effective sample size of weighted data along specified axis,
the minimum value returned is 2 to avoid non-reasonable error blow-up.</p>
<p>It is calculated via Kish’s approximate formula
from the (not necessarily normalized) weights <span class="math notranslate nohighlight">\(w_i\)</span> (see wikipedia):</p>
<div class="math notranslate nohighlight">
\[n_\mathrm{eff} = \frac{\left(\sum_i w_i\right)^2}{\sum_i w_i^2}\]</div>
<p>What it represents:
“In most instances, weighting causes a decrease in the statistical significance of results.
The effective sample size is a measure of the precision of the survey
(e.g., even if you have a sample of 1,000 people, an effective sample size of 100 would indicate
that the weighted sample is no more robust than a well-executed un-weighted
simple random sample of 100 people).” -
<a class="reference external" href="https://wiki.q-researchsoftware.com/wiki/Weights,_Effective_Sample_Size_and_Design_Effects">https://wiki.q-researchsoftware.com/wiki/Weights,_Effective_Sample_Size_and_Design_Effects</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like</p></li>
<li><p><strong>weights</strong> -- array-like
Contains weights associated with the values in data</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which the effective sample size is computed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the error of weighted circular average along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#rms"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes the root mean square along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like
Contains the data to be averaged</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which to average data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the root mean square along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">t_value_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#t_value_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculates the multiplicative correction factor to determine standard deviation of
a normally distributed quantity from standard deviation of its finite-sized sample.
The minimum allowed sample size is 2 to avoid non-reasonable error blow-up
for smaller sample sizes 2 is used instead.</p>
<p>Note (jdilly): In other words, this transforms the area of 1 sigma under
the given student t distribution to the 1 sigma area of a normal distribution
(this transformation is where the <code class="docutils literal notranslate"><span class="pre">CONFIDENCE</span> <span class="pre">LEVEL</span></code> comes in).
I hope that makes the intention more clear.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sample_size</strong> -- array-like</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>multiplicative correction factor(s) of same shape as sample_size.
Can contain nans.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">unbias_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#unbias_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes a correction factor to unbias variance of weighted average of data along specified axis,
e.g. transform the standard deviation 1</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = \frac{1}{N} \sum_{i=1}^N (x_i - x_\mathrm{mean})^2\]</div>
<p>into an un-biased estimator</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = \frac{1}{N-1} \sum_{i=1}^N (x_i - x_\mathrm{mean})^2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like</p></li>
<li><p><strong>weights</strong> -- array-like
Contains weights associated with the values in data</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which the effective sample size is computed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the error of weighted circular average along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">weighted_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_value_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#weighted_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes error of weighted average along the specified axis.
This is similar to calculating the standard deviation on the data,
but with both, the average to which the deviation is calculated,
as well as then the averaging over the deviations weighted by
weights based on the errors.</p>
<p>In addition, the weighted variance is unbiased by an unbias-factor
n / (n-1), where n is the <code class="xref py py-meth docutils literal notranslate"><span class="pre">omc3.utils.stats.effective_sample_size()</span></code> .
Additionally, a (student) t-value correction can be performed (done by default)
which corrects the estimate for small data sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like
Contains the data on which the weighted error on the average is calculated.</p></li>
<li><p><strong>errors</strong> -- array-like, optional
Contains errors associated with the values in data, it is used to calculated weights</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which to average data</p></li>
<li><p><strong>t_value_corr</strong> -- bool, optional
Species if the error is corrected for small sample size, default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the error of weighted average along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">weighted_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#weighted_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes weighted average along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like
Contains the data to be averaged</p></li>
<li><p><strong>errors</strong> -- array-like, optional
Contains errors associated with the values in data, it is used to calculated weights</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which to average data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the weighted average along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">weighted_nanmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#weighted_nanmean"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>“Wrapper around weighted_mean with added nan handling</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">weighted_nanrms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#weighted_nanrms"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>“Wrapper around weigthed_rms with added nan handling</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">weighted_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#weighted_rms"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes weighted root mean square along the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> -- array-like
Contains the data to be averaged</p></li>
<li><p><strong>errors</strong> -- array-like, optional
Contains errors associated with the values in data, it is used to calculated weights</p></li>
<li><p><strong>axis</strong> -- int or tuple of ints, optional
Axis or axes along which to average data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns weighted root mean square along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.stats.</span></span><span class="sig-name descname"><span class="pre">weights_from_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/stats.html#weights_from_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Computes weights from measurement errors, weights are not output if errors contain zeros or nans</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>errors</strong> -- array-like
Contains errors which are used to calculated weights</p></li>
<li><p><strong>period</strong> -- scalar, optional
Periodicity period of data, default is (2 * np.pi)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the error of weighted circular average along the specified axis.</p>
</dd>
</dl>
</dd></dl>

<section id="time-tools">
<h2>Time Tools<a class="headerlink" href="#time-tools" title="Link to this heading"></a></h2>
<p>Provides tools to handle times more easily, in particular to switch easily between local time
and UTC time.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">AccDatetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Wrapper for a datetime object to easily convert between local and UTC time as well as give
different presentations.</p>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Add timedelta and return as new object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cern_utc_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.cern_utc_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get utc time as string (CERN format).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">datetime</span></span></dt>
<dd><p>Return normal datetime object (in case ducktyping does not work. Looking at you, mpl!).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_cern_utc_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.from_cern_utc_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create <cite>AccDatetime</cite> object from datetime in utc string.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_local</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.from_local"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create AccDatetime object from datetime in local time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_local_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.from_local_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create <cite>AccDatetime</cite> object from datetime in local time string.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.from_timestamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create <cite>AccDatetime</cite> object from timestamp.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_utc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.from_utc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create <cite>AccDatetime</cite> object from datetime in utc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_utc_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.from_utc_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create <cite>AccDatetime</cite> object from datetime in utc string.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">local</span></span></dt>
<dd><p>Get local datetime object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">local_string</span></span></dt>
<dd><p>Get local time as string.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">local_timezone</span></span></dt>
<dd><p>Get local timezone.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">now</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.now"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create <cite>AccDatetime</cite> object at now.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#AccDatetime.sub"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Subtract timedelta and return as new object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">utc</span></span></dt>
<dd><p>Get UTC datetime object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">utc_string</span></span></dt>
<dd><p>Get utc time as string.</p>
</dd></dl>

</dd></dl>

<dl class="py data">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">AcceleratorDatetime</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'lhc':</span> <span class="pre">&lt;class</span> <span class="pre">'omc3.utils.time_tools.CERNDatetime'&gt;,</span> <span class="pre">'ps':</span> <span class="pre">&lt;class</span> <span class="pre">'omc3.utils.time_tools.CERNDatetime'&gt;,</span> <span class="pre">'sps':</span> <span class="pre">&lt;class</span> <span class="pre">'omc3.utils.time_tools.CERNDatetime'&gt;}</span></em></dt>
<dd><p>Accelerator name to AccDatetime mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">CERNDatetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#CERNDatetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p><cite>AccDatetime</cite> class for all accelerators at CERN.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">cern_utc_string_to_utc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utc_string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#cern_utc_string_to_utc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert a time string in cern-utc to a utc datetime object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">check_tz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">localized_dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timezone</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#check_tz"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Checks if timezone is correct.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">get_cern_time_format</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#get_cern_time_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Default time format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">get_cern_timezone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#get_cern_timezone"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get time zone for cern measurement data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">get_readable_time_format</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#get_readable_time_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Human readable time format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">local_string_to_utc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timezone</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#local_string_to_utc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Converts a time string in local time to UTC time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">local_to_utc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt_local</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timezone</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#local_to_utc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert local datetime object to utc datetime object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">utc_now</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#utc_now"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get UTC now as time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">utc_string_to_utc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utc_string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#utc_string_to_utc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert a time string in utc to a UTC datetime object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">omc3.utils.time_tools.</span></span><span class="sig-name descname"><span class="pre">utc_to_local</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt_utc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timezone</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/omc3/utils/time_tools.html#utc_to_local"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Convert UTC datetime object to local datetime object.</p>
</dd></dl>

</section>


           </div>
          </div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tune_analysis.html" class="btn btn-neutral float-left" title="Tune Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>