title, "Model creator for java";

!@require lhc_runIII_2022.macros.madx

option, -echo;

call, file = "/afs/cern.ch/eng/acc-models/lhc/2022/lhc.seq";

exec, define_nominal_beams();
call, file = "/afs/cern.ch/eng/acc-models/lhc/2022/operation/optics/R2022a_A30cmC30cmA10mL200cm.madx";
exec, cycle_sequences();
if(0==1){
exec, set_crossing_scheme_ON();
}else{
exec, set_default_crossing_scheme();
}
use, period = LHCB1;

option, echo;

exec, match_tunes(0.28, 0.31, 1);

!!! for ATS MD
! exec, full_response_ats();

select, flag=twiss, clear;
select, flag=twiss, pattern="BPM.*\.B1", column=NAME,S,BETX,ALFX,BETY,ALFY,DX,DY,DPX,DPY,X,Y,K1L,MUX,MUY,R11,R12,R21,R22;

exec, coupling_knob(1);

call, file="/afs/cern.ch/work/m/mlegarre/public/jupyter/resonance_driving_terms/measurements/2022-06-24/Analysis/Model/iter.madx";

stop;
